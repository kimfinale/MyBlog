{
  "hash": "6ed4f62fbd8927a958d366a6ac0696be",
  "result": {
    "markdown": "---\ntitle: \"Prevalence vs. incidence for the SIR model\"\nauthor: \"Jong-Hoon Kim\"\ndate: \"2024-03-12\"\ncategories: [R, prevalence, incidence, deSolve]\nimage: \"diffeqr_sir.png\"\neditor_options: \n  chunk_output_type: console\n---\n\n\n\n\n### SIR model with constant incidence rate\n\nIn the following, I implemented a simple model of disease incidence and recovery. Susceptibles are infected at a constant rate, go through the natural history of infection, and finally recover at a constant rate. Infection and recovery follow the exponential decay. This is to explore the relationship between the incidence and prevalence. If the prevalence of a disease is less than 10%, the relationship is often described as follows (e.g., see the [link](https://sphweb.bumc.bu.edu/otlt/MPH-Modules/PH717-QuantCore/PH717-Module3-Frequency-Association/PH717-Module3-Frequency-Association5.html)): $$\n\\text{Prevalence} = \\text{IR} \\times \\text{Average Duration of a Disease} \n$$ I have computed the prevalence in three ways. In particular, I assumed a short-lived infection (e.g., 2 weeks) of infectious diseases but with a long-lasting immunity. Therefore, prevalence may mean the proportion of the population immune to infection in this context. First, I use the above method. Second, I developed a simple set of differential equations to model disease incidence and recovery. Finally, I derived analytical solutions to the differential equations.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Prevalence according to the above equation\nir <- 100/100000 # incidence rate per 100,000 person-years\ndur_R <- 20 # duration of infection-derived immunity (20 years).\nprev <- ir * dur_R \n\n# Prevalence according to the differential equation\n# Note that the incidence rate (or force of infection) remains constant in this model unlike the classic SIR model.\nsir_beta_const <- function(t, u, p){\n  N <- sum(u)\n  du1 <- - p[1]*u[1] + p[3]*u[3]\n  du2 <- + p[1]*u[1] - p[2]*u[2]\n  du3 <- + p[2]*u[2] - p[3]*u[3]\n    \n  return(list(c(du1,du2,du3))) \n}\nlibrary(deSolve)\nu0 <- c(0.99, 0.01, 0)\ntspan <- seq(from=0, to=300)\ndur_I <- 14/365\nr <- -log(1-ir) # instantaneous rate for the yearly incidence rate, ir\np <- c(r, 1/dur_I, 1/dur_R)\noutdf <- as.data.frame(ode(y=u0, times=tspan, func=sir_beta_const, parms=p))\n\n## to explore visually as well\nlibrary(ggplot2)\nextrafont::loadfonts(\"win\", quiet=TRUE)\ntheme_set(hrbrthemes::theme_ipsum_rc(base_size=14, subtitle_size=16, axis_title_size=12))\n\nggplot(outdf,aes(x=time))+\n  geom_line(aes(y=`1`, color=\"S\")) +\n  geom_line(aes(y=`2`, color=\"I\")) +\n  geom_line(aes(y=`3`, color=\"R\")) +\n  scale_color_manual(\"\",values=c(\"S\"=\"steelblue\",\"I\"=\"firebrick\",\n                              \"R\"=\"darkgreen\"))+\n  labs(y=\"Number of individuals\", x=\"Time\", color=\"\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Prevalence according to analytic solutions for the ODE model\n# Refer to the equations below\ngamma <- 1/dur_I\nmu <- 0 # natural death rate, which was not implemented in the ODE model\nomega <- 1/dur_R\n# according the following equations\nr_eq <- (r*gamma)/((gamma + mu)*(mu + omega) + r*(gamma + mu + omega))\n\n# Compare three values\nr_eq\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.01961672\n```\n:::\n\n```{.r .cell-code}\ntail(outdf$`3`, 1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.01961672\n```\n:::\n\n```{.r .cell-code}\nprev\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.02\n```\n:::\n:::\n\n\nThe following Mathematica commands produce the steady state for S, I (written as Y below), R\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# FullSimplify[Solve[{\\[Mu]*(S+Y+R)-(r +\\[Mu]) *S + \\[Omega]* R==0, r *S-(\\[Mu]+\\[Gamma]) *Y == 0, \\[Gamma]* Y-(\\[Omega]+\\[Mu])*R==0,S+Y+R==1, \\[Mu]>0,r>0,\\[Gamma]>0,\\[Omega]>0, S>0,Y>0,R>0,S\\[Element]Reals,Y\\[Element]Reals,R\\[Element]Reals}, {S,Y,R}]]\n```\n:::\n\n\n$$S = \\frac{(\\gamma +\\mu ) (\\mu +\\omega )}{(\\gamma +\\mu ) (\\mu +\\omega )+r (\\gamma +\\mu +\\omega )}$$\n\n$$I =\\frac{r (\\mu +\\omega )}{(\\gamma +\\mu ) (\\mu +\\omega )+r (\\gamma +\\mu +\\omega )}$$ $$R = \\frac{\\gamma  r}{(\\gamma +\\mu ) (\\mu +\\omega )+r (\\gamma +\\mu +\\omega )}$$\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}