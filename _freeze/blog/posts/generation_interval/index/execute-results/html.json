{
  "hash": "2e582695bb9b5671cb47da05dcfd6f0b",
  "result": {
    "markdown": "---\ntitle: \"Generation interval, growth rate, reproduction number\"\nauthor: \"Jong-Hoon Kim\"\ndate: \"2023-12-06\"\ncategories: [generation interval, growth rate, reproduction number]\nimage: \"sample_figure.png\"\neditor_options: \n  chunk_output_type: console\n---\n\n\n\n\n### Growth rate, generation interval, and reproduction number\n\n[Wallinga and Lipsitch](https://royalsocietypublishing.org/doi/10.1098/rspb.2006.3754?url_ver=Z39.88-2003&rfr_id=ori%3Arid%3Acrossref.org&rfr_dat=cr_pub++0pubmed) wrote a highly cited paper about the reproduction number. It discusses how to derive reproduction number, $R$, given the growth rate, $r$, and the generation interval, $T_c$.\n\n$$\n\\begin{align}\nR &= 1 + r/b\\\\\nR &= (1 + r/b_1)(1 + r/b_2)\\\\\nR &= \\frac{(1 + r/b_1)^x}{\\sum_{i=1}^y(1 + r/b_2)^{-i}}\\\\\n\\end{align}\n$$\n\nI can seem to use the third equation to reproduce the answer to the example the authors provided. On page 603, the authors gave the example of Influenza A where the generation interval has a mean of 2.85 days with the standard deviation of 0.93 days. The epidemic growth rate $r = 0.2$. \"The $R=1.57$ for the SIR epidemic model, a value of $R=1.65$ for the SEIR epidemic model and a value of $R=1.66$ the more complicated epidemic model with one latent stage and two infectious stages (equation (3.3), with $x=1, y=2$)\"\n\nI tried to reproduce the results.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nTc = 2.85\nsigma = 0.93\nr = 0.2\n# for the SIR model\nb = 1/Tc\n(R = 1 + r/b)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1.57\n```\n:::\n\n```{.r .cell-code}\n# for the SEIR model, assume that b1 and b2 are the same\nb1 = b2 = 2/Tc\n(R = (1 + r/b1)*(1 + r/b2))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1.651225\n```\n:::\n:::\n\n\nFor the model with $x=1, y=2$, the $R$ is not the same as provided. $R$ can vary depending on how we set $b_1$ and $b_2$, but it is smaller than one.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# for the SEIR model with x=1, y=2 (i.e., two consecutive . assume that b1 and b2 are the same\nx = 1\ny = 2\nb1 = 2/Tc\nb2 = 4/Tc\n\nnumer = function(x) (1 + r/b1)^x\ndenom = function(y) sum(sapply(1:y, function(i) (1+r/b2)^(-i)))\n\n(R = numer(x=x)/denom(y=y))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.7828791\n```\n:::\n:::\n\n\nThe study also refers to [Wearing et al. (2005)](https://journals.plos.org/plosmedicine/article?id=10.1371/journal.pmed.0020174) study and the result is below. Again, it is not $R=1.66$\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# as presented in Wearing et al.(2005)\n\nm = 1\nn = 2\nb1 = 2/Tc\nb2 = 4/Tc\n\nnumer = r*(r/(b1*m)+1)^m\ndenom = b2*(1-(r/(b2*n)+1)^(-n))\n(R = numer / denom)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1.423909\n```\n:::\n:::\n\n\nI implemented moment generating function to see if I can reproduce the results this way. One important aspect is that how we should set the rate to get the generation interval we want.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmgf = function(b, r) b / (b + r)\n\n1/mgf(b=1/Tc, r=r)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1.57\n```\n:::\n\n```{.r .cell-code}\nmgf_recursion = function(c, b, r){\n  l = length(b)\n  if (l == 1) {\n    c * mgf(b, r)\n  } \n  else {\n    c[l] * mgf(b[l], r) * mgf_recursion(c=rep(1,length(b[1:(l-1)])), b=b[1:(l-1)], r=r)\n  }\n}\n\nc = c(0,1/2,1/2)\nb = c(3,3,3)/Tc\n\nR0_recursion = function(c,b,r){\n  out <- rep(NA, length(b))\n  for (i in seq_along(b)) {\n    out[i] = mgf_recursion(c[1:i], b[1:i], r)\n  }\n  1/sum(out)\n}\n\nR0_recursion(c=c(1), b=c(1)/Tc, r=0.2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1.57\n```\n:::\n\n```{.r .cell-code}\nR0_recursion(c=c(0,1), b=c(2,2)/Tc, r=0.2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1.651225\n```\n:::\n\n```{.r .cell-code}\n# for y=2 (i.e., Gamma distribution with shape=2)\n# use the relationship \n# average time to infection = beta*(1+alpha)/2 where beta and alpha represent scale and shape\n# beta*(1+alpha)/2 = Tc/2\n# rate = b = (1+alpha)/Tc\nR0_recursion(c=c(0,1/2,1/2), b=c(2,3,3)/Tc, r=0.2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1.661816\n```\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}