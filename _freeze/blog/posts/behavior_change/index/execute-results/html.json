{
  "hash": "b32dad1c80376b71c13eb9992fdf2625",
  "result": {
    "markdown": "---\ntitle: \"Modeling human behavior: Infectious disease transmission modeling perspective\"\nauthor: \"Jong-Hoon Kim\"\ndate: \"2024-07-21\"\ncategories: [Bayesian workflow, negative binomial, social contact]\nimage: \"sample_figure.png\"\neditor_options: \n  chunk_output_type: console\n---\n\n\n\n\n## Epidemiology\n\n사람의 질병 발생 패턴을 연구하는 학문을 역학, 영어로는 [epidemiology](https://www.bmj.com/about-bmj/resources-readers/publications/epidemiology-uninitiated/1-what-epidemiology),이라고 한다. 패턴을 이해하는 데 필수적인 세가지 축은 감염원 (infectious agent), 환경 (environment), 숙주 (host) 이다.  \n\n연구하는 세 가지 패턴은 \n\n그 중에 감염병학 (epidemiology))사람 간 감염병 전파에 효과적으로 대처하기 위해서는 감염병 전파에 잘 이해하여야 한다. 이러한 감염병 역학 (epidemiology)을  감염병 전파를 잘 이해하기 위해서는 감염원 (infectious agent)에 대한 이해가 필수적인데 그에 못지 않게 중요할 수 있는 것이 감염병의 전파에 반응하여 시시각각 변할 수 있는 사람 (host). Sebastian Funk *et al*. 의 논문 [Modelling the influence of human behaviour on the spread of infectious diseases: a review](https://royalsocietypublishing.org/doi/full/10.1098/rsif.2010.0142)\n을 살펴보고자 한다. \n\n\n논문에서 다음과 같이 적었다:\n\n> \"... After all, individual self-initiated behaviour can change the fate of an outbreak, and its interaction with disease dynamics requires proper understanding if we are to fully comprehend what happens when a disease spreads through human populations Ferguson *et al*. [Capturing human behaviour](https://www.nature.com/articles/446733a). ... \"  \n\n## Model building\n\n### Conceptual analysis\n\nLet's suppose that we measured how the number of contact a person makes varies.[A prior study](https://journals.plos.org/plosmedicine/article?id=10.1371/journal.pmed.0050074) and other numerous studies showed that contact frequencies differ by age. And a significant fraction of contacts occur with household members and as such the contact frequencies will likely vary by household size. We sampled a group of people and followed them for some time (e.g., 1 week) and measured the number of contacts that a typical person makes in a day. We also collected variables such as age, sex, and household size.\n\nThere are three conceptual modelling approaches: descriptive, predictive and explanatory approaches as per [the study by Shmueli](https://www.stat.berkeley.edu/~aldous/157/Papers/shmueli.pdf). This study is best described as a descriptive study and does not directly aim at obtaining optimal predictive performance, but at capturing the data structure parsimoniously. For a descriptive model, interpretability, transportability and general usability are important criteria as described in the [article](ttps://diagnprognres.biomedcentral.com/articles/10.1186/s41512-020-00074-3). \n\nAssuming that the number of contacts per day per person, $y_i$, follows a negative binomial distribution, we can mathematically express our concepts in the following equations:\n\n$$\ny_i \\sim \\text{NB}(y_i|\\mu_i,\\phi)=\\frac{\\Gamma (y_i + \\theta)}{\\Gamma (\\theta) y_i !}) \\left(\\frac{\\mu_i}{\\mu_i+\\phi} \\right)^y \\left(\\frac{\\phi}{\\mu_i+\\phi} \\right)^\\phi\n$${#eq-nb}\n\n$$\\text{log}(\\mu_i)= \\alpha + \\beta_{\\text{age}_i}  + \\beta_{\\text{sex}_i} +\\beta_{\\text{hhsize}_i}$${#eq-mu}\n\n$\\mu_i$ and $\\phi$ represent the mean number of contacts per day for a person $i$ and the shape parameter of the negative binomial distribution, respectively. $\\Gamma (\\cdot)$ denotes a [gamma function](https://en.wikipedia.org/wiki/Gamma_function).\n\n### Implemetation\n\nLoad packages\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# library(posterior)\n# options(pillar.neg = FALSE, pillar.subtle=FALSE, pillar.sigfig=2)\nlibrary(brms)\nlibrary(tidyverse)\n# library(bayesplot)\n# theme_set(bayesplot::theme_default(base_family = \"sans\"))\nset1 <- RColorBrewer::brewer.pal(7, \"Set1\")\n```\n:::\n\n\nGenerate the fake data\n\nWe take the fake-data simulation approach, which can help us understand our\ndata model and priors, what can be learned from an experiment, and the validity of the applied inference methods. Parameters of interest are the ratios of number of contacts per day (i.e., rate ratios or relative risks) by age, sex, and household size. Plugging @eq-mu into @eq-nb becomes our generative model.\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}